@{
    ViewData["Title"] = "Export Data";
}

<h2>Export Data</h2>

<!-- Dropdown pro export Hive a Apiary measurements -->
<div>
    <h3>Export Hive Measurements</h3>
    <select id="hiveMeasurementPeriod" class="form-select">
        <option value="24h">Posledních 24 hodin</option>
        <option value="7d">Posledních 7 dní</option>
        <option value="30d">Posledních 30 dní</option>
        <option value="all">Všechna data</option>
    </select>
    <button class="btn btn-primary mt-2" onclick="exportData('HiveMeasurements')">Export</button>
</div>

<div>
    <h3>Export Apiary Measurements</h3>
    <select id="apiaryMeasurementPeriod" class="form-select">
        <option value="24h">Posledních 24 hodin</option>
        <option value="7d">Posledních 7 dní</option>
        <option value="30d">Posledních 30 dní</option>
        <option value="all">Všechna data</option>
    </select>
    <button class="btn btn-primary mt-2" onclick="exportData('ApiaryMeasurements')">Export</button>
</div>

<!-- Tabulka s checkboxy pro výběr entit -->
<div class="mt-4">
    <h3>Export vybraných entit</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Vybrat</th>
                <th>Entity</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input type="checkbox" value="Hives" class="entity-checkbox" /></td>
                <td>Hives</td>
            </tr>
            <tr>
                <td><input type="checkbox" value="Apiary" class="entity-checkbox" /></td>
                <td>Apiary</td>
            </tr>
            <tr>
                <td><input type="checkbox" value="ApiaryMeasurement" class="entity-checkbox" /></td>
                <td>Apiary Measurement</td>
            </tr>
            <tr>
                <td><input type="checkbox" value="HiveMeasurement" class="entity-checkbox" /></td>
                <td>Hive Measurement</td>
            </tr>
            <tr>
                <td><input type="checkbox" value="InspectionReport" class="entity-checkbox" /></td>
                <td>Inspection Report</td>
            </tr>
        </tbody>
    </table>
    <button class="btn btn-secondary" onclick="exportSelectedEntities()">Export</button>
</div>

<script>
    // Export dat podle časového období a tabulky
    function exportData(table) {
        const period = document.getElementById(table === "HiveMeasurements" ? "hiveMeasurementPeriod" : "apiaryMeasurementPeriod").value;

        fetch('/Export/ExportData', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ table, period })
        })
        .then(response => response.json())
        .then(data => {
            console.log(data); // Zde můžete implementovat logiku pro stažení JSON souboru
            alert(`Data byla exportována: ${JSON.stringify(data)}`);
        })
        .catch(error => console.error(error));
    }

    // Export dat z vybraných entit
    function exportSelectedEntities() {
        const selectedEntities = Array.from(document.querySelectorAll('.entity-checkbox:checked')).map(cb => cb.value);

        fetch('/Export/ExportSelectedEntities', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ selectedEntities })
        })
        .then(response => response.json())
        .then(data => {
            console.log(data); // Zde můžete implementovat logiku pro stažení JSON souboru
            alert(`Data byla exportována: ${JSON.stringify(data)}`);
        })
        .catch(error => console.error(error));
    }
</script>